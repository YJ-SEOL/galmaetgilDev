"use strict";(self["webpackChunkfront_end"]=self["webpackChunkfront_end"]||[]).push([[716],{46716:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page"},[n("main",{staticClass:"mypage"},[n("section",{staticClass:"plogging__info",attrs:{"aria-label":"plogging__info"}},[n("div",{staticClass:"profile__info"},[n("p",{staticClass:"elements__sum_title"},[n("strong",[e._v(e._s(e.count))]),e._v("번의 플로깅에 동참하셨습니다. ")])]),n("button",{staticClass:"open-popup profile__add-button ml-3",attrs:{type:"button","aria-label":"add button"}})]),n("section",{staticClass:"elements",attrs:{"aria-label":"photo"}},e._l(e.imageInfo,(function(t,a){return n("div",{key:a,staticClass:"card",attrs:{id:"element-template"}},[n("article",{staticClass:"element"},[n("button",{staticClass:"element__trash",attrs:{type:"button","aria-label":"delete button"},on:{click:function(t){return e.deletePhoto(a)}}}),n("img",{staticClass:"element__image",attrs:{src:t.url,alt:""}})])])})),0),n("div",{staticClass:"pageSelect"},[n("div",{staticClass:"pageSize"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.pageSize,expression:"pageSize"}],on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.pageSize=t.target.multiple?n:n[0]},function(t){return e.handlePageSizeChange(t)}]}},e._l(e.pageSizes,(function(t){return n("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0),e._v(" 개씩 보기 ")]),n("div",{staticClass:"pagination"},[n("b-pagination",{attrs:{"total-rows":e.count,"per-page":e.pageSize,"prev-text":"Prev","next-text":"Next"},on:{change:e.handlePageChange},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)])]),n("div",{staticClass:"popup popup-add"},[n("div",{staticClass:"popup__container"},[n("button",{staticClass:"popup-add__close-button popup__close-button mt-3",attrs:{type:"button"}}),n("h2",{staticClass:"popup__title"},[e._v("New Photo")]),n("form",{staticClass:"popup__form form-add form",attrs:{name:"add-form",id:"form-add",novalidate:""}},[n("label",{staticClass:"form-label",attrs:{for:"formFileSm"}},[n("input",{ref:"file",staticClass:"form-control form-control-sm",attrs:{id:"formFileSm",type:"file",accept:"image/*"},on:{change:e.selectImage}})]),e.previewImage?n("div",{staticClass:"container add-image__preview"},[n("img",{staticClass:"add-image__image",attrs:{src:e.previewImage,alt:""}})]):e._e(),e.currentImage?n("div",{staticClass:"progress"},[n("div",{staticClass:"progress-bar progress-bar-striped progress-bar-animated bg-info",style:{width:e.progress+"%"},attrs:{role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"}},[e._v(" "+e._s(e.progress)+"% ")])]):e._e(),n("span",{staticClass:"form__input-link-error"}),n("button",{staticClass:"popup__button popup-add__button form__button",attrs:{type:"submit",disabled:!e.currentImage},on:{click:e.upload}},[e._v(" Add Photo ")]),e.message?n("div",{staticClass:"alert alert-secondary",attrs:{role:"alert"}},[e._v(" "+e._s(e.message)+" ")]):e._e()])])])])},r=[],s=(n(41539),n(78783),n(33948),n(60285),n(41637),n(83597)),i=n(71253);const o={name:"Profile",data:function(){return{currentImage:void 0,previewImage:void 0,progress:0,message:"",mes:"",imageInfo:[],page:1,count:0,pageSize:3,pageSizes:[3,6,9],usernick:"",url:"",openModal:!1,clicked:!1,currentIndex:-1}},methods:{refreshList:function(){this.currentImage=null,this.currentIndex=-1,this.retrieveUpload()},getRequestParams:function(e,t,n,a){var r={};return e&&(r["username"]=e),t&&(r["usernick"]=t),n&&(r["page"]=n-1),a&&(r["size"]=a),console.log(r),r},retrieveUpload:function(){var e=this,t=this.getRequestParams(this.currentUser.username,this.currentUser.usernick,this.page,this.pageSize);console.log(t),s.Z.getFiles(t).then((function(t){e.imageInfo=t.data,e.count=e.imageInfo[0].totalItems})),console.log(t)},selectImage:function(){this.currentImage=this.$refs.file.files.item(0),this.previewImage=URL.createObjectURL(this.currentImage),this.progress=0,this.message=""},upload:function(){var e=this;this.progress=0,s.Z.upload(this.currentUser.username,this.currentUser.usernick,this.currentImage,(function(t){e.progress=Math.round(100*t.loaded/t.total)})).then((function(t){var n=e.getRequestParams(e.currentUser.username,e.currentUser.usernick,e.page,e.pageSize);return e.message=t.data.message,s.Z.getFiles(n)})).then((function(t){e.imageInfo=t.data,console.log("ㅋㅋㅋㅋㅋ"+t.data)}))["catch"]((function(t){e.progress=0,e.message="Could not upload the image!"+t,e.currentImage=void 0}))},deletePhoto:function(e){var t=this;s.Z["delete"](this.imageInfo[e].id).then((function(){alert("삭제가 완료되었습니다"),t.refreshList()}))["catch"]((function(e){alert(e)}))},handlePageChange:function(e){this.page=e,this.retrieveUpload()},handlePageSizeChange:function(e){this.pageSize=e.target.value,this.page=1,this.retrieveUpload()}},computed:{currentUser:function(){return this.$store.state.auth.user}},mounted:function(){this.currentUser||this.$router.push("/login"),this.retrieveUpload(),(0,i.Z)()}},l=o;var u=n(1001),c=(0,u.Z)(l,a,r,!1,null,"3ccf77c0",null);const p=c.exports},71253:(e,t,n)=>{n.d(t,{Z:()=>c});n(89554),n(41539),n(54747);var a=n(76133),r=n(92751),s=(n(29254),n(68309),function(){function e(t,n,r){(0,a.Z)(this,e),this._link=t.link,this._name=t.name,this._cardSelector=n,this._card=this._getTemplate(),this._cardLink=this._card.querySelector(".element__image"),this._trashBtn=this._card.querySelector(".element__trash"),this._openImage=r}return(0,r.Z)(e,[{key:"_getTemplate",value:function(){var e=document.querySelector(this._cardSelector).querySelector(".element").cloneNode(!0);return e}},{key:"_cardDelete",value:function(){this._trashBtn.closest(".element").remove()}},{key:"_setEventListeners",value:function(){var e=this;this._trashBtn.addEventListener("click",(function(){e._cardDelete()})),this._cardLink.addEventListener("click",(function(){e._openImage(e._name,e._link)}))}},{key:"generateCard",value:function(){return this._cardLink.src=this._link,this._setEventListeners(),this._card}}]),e}()),i=(n(91038),n(78783),n(5212),function(){function e(t,n){(0,a.Z)(this,e),this._validate=t,this._form=n,this._inputList=Array.from(this._form.querySelectorAll(this._validate.inputSelector)),this._buttonElement=this._form.querySelector(this._validate.submitButtonSelector)}return(0,r.Z)(e,[{key:"_showInputError",value:function(e){var t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.add(this._validate.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._validate.errorClass)}},{key:"_hideInputError",value:function(e){var t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._validate.inputErrorClass),t.classList.remove(this._validate.errorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"toggleButtonState",value:function(){this._hasInvalidInput()?(this._buttonElement.disabled="disabled",this._buttonElement.classList.add(this._validate.inactiveButtonClass)):(this._buttonElement.disabled="",this._buttonElement.classList.remove(this._validate.inactiveButtonClass))}},{key:"_setEventListeners",value:function(){var e=this;this.toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e.toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._form.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}]),e}()),o=[{link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],l={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"};function u(){var e=document.querySelector(".popup-edit"),t=document.querySelector(".popup-add"),n=document.querySelector(".form-add"),a=document.querySelector(".form-edit"),r=document.querySelector(".popup-image"),u=document.querySelector(".profile__add-button"),c=document.querySelector(".profile__name"),p=document.querySelector(".popup__input_value_name"),d=document.querySelector(".popup__input_value_link"),m=document.querySelector(".elements"),_=document.querySelector(".popup-image__image"),h=document.querySelector(".popup-image__title"),v=new i(l,a),f=new i(l,n);function g(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",k)}function y(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",k)}function k(e){if("Escape"===e.key){var t=document.querySelector(".popup_is-opened");y(t)}}function b(e){e.target===e.currentTarget&&y(e.target)}function C(t){t.preventDefault(),c.textContent=p.value,y(e),v.toggleButtonState()}function S(e,t){g(r),_.src=t,_.alt=e,h.textContent=e}function I(e){e.preventDefault();var n={};n.link=d.value,E(n),e.target.reset(),y(t),f.toggleButtonState()}function L(e){var t=new s(e,".card",S);return t.generateCard()}function E(e){m.prepend(L(e))}u.addEventListener("click",(function(){g(t)})),document.querySelectorAll(".popup__close-button").forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return y(t)}))})),document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("mousedown",b)})),t.addEventListener("submit",C),e.addEventListener("submit",C),t.addEventListener("submit",I),o.forEach(E),v.enableValidation(),f.enableValidation();document.querySelector(".elements__sum_title");var q=document.querySelectorAll(".element"),w=q.length;q[w-1].remove()}const c=u},32327:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(26166),r=n.n(a);const s=r().create({baseURL:"http://localhost:8000/api",headers:{"Content-type":"application/json"}})},83597:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(76133),r=n(92751),s=n(32327),i=function(){function e(){(0,a.Z)(this,e)}return(0,r.Z)(e,[{key:"upload",value:function(e,t,n,a){var r=new FormData;return r.append("username",e),r.append("usernick",t),r.append("file",n),s.Z.post("/uploadpf",r,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a})}},{key:"getFiles",value:function(e){return s.Z.get("/filespf",{params:e})}},{key:"delete",value:function(e){return s.Z.put("/filespf/deletion/".concat(e))}}]),e}();const o=new i}}]);
//# sourceMappingURL=716.2c9aedbe.js.map